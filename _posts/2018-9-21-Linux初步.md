---
layout: post
title:  "Linux初步"
date:   2018-9-21 10:45:13 -0400
background: '/img/posts/07.jpg'
---
[x] 下载最新稳定版Linux kernel

[x] 展开并检查所有内核配置项

[x] 对照windows硬件设备管理器检视设备配置

## 版本号命名含义

`rc`: release-candidate 候选发布版

`EOF`: end of life 该版本不再被支持

`longterm`: 长期支持版本

## Linux内核配置

- 下载源码包，并在虚拟机中解开

- 选项配置命令
  - make conifg：交互式问答，将近500+问题，逐一回答，体验感差
  - make menuconfig：文本界面，更人性化
  - make xconfig：图形界面
- 内核config选择方法：可以先全部配置
  - make allyesconfig：尽可能多的选择“是”并创建组态文件 
  - make allmodconfig
  - make localmodconfig：根据本机的模块为基础（lsmod），加载所有驱动
  - make localyesconfig：会在所有的模块选项中选择“是”

*在README中有很多隐藏信息*

- 内核的编译

  使用`make -j 4`并行编译

- 新内核的安装

  - 新内核文件bzimage，放在boot下，修改grub
  - 模块文件
    - 用make modules_install安装
    - 路径在/lib/modules下



----------------------------------------------------



- `tar.xz`文件的解压：

  `xz`是压缩方式，`tar`是打包方式，所以要先用`xz -d ***tar.xz`压缩，再用`tar -xvf ***.tar`解压

- `make localmodconfig`  VS `make localyesconfig`

  - make localyesconfig: 将所有可装载模块（LKM）都编译进内核 
  - make localmodconfig: 根据当前已加载模块列表和系统配置来生成配置文件 

- 查看物理CPU个数，核数，逻辑CPU个数

  > 总核数 = 物理CPU个数 X 每颗物理CPU的核数
  >
  > 总逻辑CPU数 = 物理CPU个数 X 每颗物理CPU的核数 X 超线程数

  ````shell
  # 查看物理CPU个数
  cat /proc/cpuinfo| grep "physical id"| sort| uniq| wc -l
  
  # 查看每个物理CPU中core的个数(即核数)
  cat /proc/cpuinfo| grep "cpu cores"| uniq
  
  # 查看逻辑CPU的个数
  cat /proc/cpuinfo| grep "processor"| wc -l
  ````

  ![1537494848737](C:\Users\邬\AppData\Local\Temp\1537494848737.png)



## 进度

- make完成

